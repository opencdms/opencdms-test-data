version: "3"

services:
  # An empty TimescaleDB / PostGIS instance for deploying schemas from multiple supported CDMSs (currently empty)
  opencdms-db:
    build:
      context: .
      dockerfile: ./docker/Dockerfile
    container_name: opencdms-db

  # A PostgreSQL instance containing schemas from CDMSs that use PostgreSQL (currently clide and wmdr)
  postgresql:
    build:
      context: .
      dockerfile: ./docker/groups/Dockerfile.postgresql
    container_name: postgresql

  # A MariaDB instance containing schemas from CDMSs that use MySQL/MariaDB (currently climsoft-4.1.1 and mch-english)
  mariadb:
    build:
      context: .
      dockerfile: ./docker/groups/Dockerfile.mariadb
    container_name: mariadb

  # An Oracle Express Edition instance containing schemas from CDMSs that use Oracle (currently midas-core)
  oracle-xe:
    build:
      context: .
      dockerfile: ./docker/groups/Dockerfile.oracle-xe
    container_name: oracle-xe

  # A PostgreSQL 13 instance containing the clide schema (comparable to how CliDE is used in production)
  clide:
    build:
      context: .
      dockerfile: ./docker/Dockerfile.clide
    container_name: clide
    ports:
      - 5432:5432
    environment:
      - POSTGRES_PASSWORD=password

  # A MariaDB 10.1 instance containing the climsoft-4.1.1 schema (comparable to how Climsoft is used in production)
  climsoft-4.1.1:
    build:
      context: .
      dockerfile: ./docker/Dockerfile.climsoft-4.1.1
    container_name: climsoft-4.1.1
    ports:
      - 3306:3306
    environment:
      - MYSQL_ROOT_PASSWORD=password

  # MySQL 5.1.17 instance containing the mch-english schema (comparable to how MCH is used in production)
  mch-english:
    build:
      context: .
      dockerfile: ./docker/Dockerfile.mch-english
    container_name: mch-english
    ports:
      - 3307:3306
    environment:
      - MYSQL_ROOT_PASSWORD=password

  # A TimescaleDB / PostGIS instance containing the wmdr schema
  wmdr:
    build:
      context: .
      dockerfile: ./docker/Dockerfile.wmdr
    container_name: wmdr
    ports:
      - 5433:5432
    environment:
      - POSTGRES_PASSWORD=password



